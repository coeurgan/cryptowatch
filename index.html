<!DOCTYPE html>
<html>
<head>
<title>TESTS JGL</title></head>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
<body>

<div ng-app="myApp" ng-controller="namesCtrl">

<p>Looping with objects:</p>
<table>
<tr ng-repeat="x in coins">
  <td>{{ x.code}}</td>
  <td>{{ x.quantity}}</td>
  <td>{{ x.target}}</td>
  <td>{{ x.index}}</td>
  <td>{{ x.price_usd}}</td>
</tr>
</table>

</div>

<script>
angular.module('myApp', []).controller('namesCtrl', function($scope, $http) {
  $scope.coins = [ 
		{ code : "XRB", quantity : "10", target : "10000" }, 
		{ code : "XBY", quantity : "100", target : "5000" },
		{ code : "ETH", quantity : "1", target : "5000" }
		];
   $scope.cmcinfos = [];
   //var hashCoins = {};
   var codes = "";
  for (i = 0; i < $scope.coins.length; i++) {
     var coin = $scope.coins[i]
     coin.index = i
     //hashCoins[coin.code] = coin;
     codes = codes + coin.code + ",";
  }
  var data;
  var url = "https://min-api.cryptocompare.com/data/pricemulti?fsyms="+codes+"&tsyms=USD";
  console.log(url);
     $http.get(url)
      .then(function(response) {
        data = response.data;
	console.log(data);
	//coin.price_usd = data.USD;
	for (i = 0; i < $scope.coins.length; i++) {
		var coin = $scope.coins[i];
		coin.price_usd = data[coin.code].USD;
		//hashCoins[coin.code] = coin;
	}
    });
});
</script>

</body>
</html>
